<div class="profile-container">
  <% if (profileError) { %>
    <div class="error-banner">
      <p><%= profileError %></p>
      <a href="/main/profile" class="retry-button">Try Again</a>
    </div>
  <% } %>

  <div class="profile-view" id="profileView">
    <!-- View Mode -->
    <div class="avatar-container">
      <img src="<%= user.avatarUrl %>" alt="Profile Picture" class="profile-avatar">
    </div>
    <h2><%= user.username %></h2>
    <p>Member since: <%= new Date(user.createdAt).toLocaleDateString() %></p>
    
    <% if (user.phone) { %>
      <p class="profile-phone">Phone: <%= user.phone %></p>
    <% } %>
    
    <div class="bio-section">
      <p id="bioText"><%= user.bio || 'No bio provided' %></p>
    </div>

    <div class="profile-actions">
      <button class="btn-edit" id="editProfileBtn">Edit Profile</button>
    </div>
  </div>

  <div class="profile-edit" id="profileEdit" style="display: none;">
    <!-- Edit Mode -->
    <form id="profileEditForm">
      <div class="form-group">
        <label>Profile Picture</label>
        <div class="avatar-upload">
          <img src="<%= user.avatarUrl %>" id="avatarPreview" class="profile-avatar">
          <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
          <button type="button" class="btn-upload" id="changeAvatarBtn">Change Avatar</button>
        </div>
      </div>
      
      <div class="form-group">
        <label for="editUsername">Username</label>
        <input type="text" id="editUsername" value="<%= user.username %>" required>
      </div>
      
      <div class="form-group">
        <label for="editPhone">Phone Number</label>
        <input type="tel" id="editPhone" value="<%= user.phone || '' %>">
      </div>
      
      <div class="form-group">
        <label for="editBio">Bio</label>
        <textarea id="editBio"><%= user.bio || '' %></textarea>
      </div>

      <div class="password-section">
        <h3>Change Password</h3>
        <div class="form-group">
          <label for="currentPassword">Current Password</label>
          <input type="password" id="currentPassword">
        </div>
        <div class="form-group">
          <label for="newPassword">New Password</label>
          <input type="password" id="newPassword">
        </div>
        <div class="form-group">
          <label for="confirmPassword">Confirm New Password</label>
          <input type="password" id="confirmPassword">
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-save">Save Changes</button>
        <button type="button" class="btn-cancel" id="cancelEditBtn">Cancel</button>
      </div>
    </form>
  </div>
</div>